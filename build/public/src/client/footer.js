"use strict";define("forum/footer",["notifications","chat","components","translator"],function(t,n,a,e){t.prepareDOM();n.prepareDOM();e.prepareDOM();function i(t,n){if(!utils.isNumber(n)){return}$('a[href="'+config.relative_path+t+'"].navigation-link i').toggleClass("unread-count",n>0).attr("data-content",n>99?"99+":n)}function r(t){a.get("chat/icon").toggleClass("unread-count",t>0).attr("data-content",t>99?"99+":t)}function o(){var t={};function n(n){if(n&&n.posts&&n.posts.length){var i=n.posts[0];if(parseInt(i.uid,10)!==parseInt(app.user.uid,10)&&!t[i.topic.tid]){a(n);e(i.topic.tid);t[i.topic.tid]=true}}}function a(t){var n=t.posts[0];var a=parseInt($('a[href="'+config.relative_path+'/unread"].navigation-link i').attr("data-content"),10)+1;i("/unread",a);var e=n.isMain&&parseInt(n.uid,10)!==parseInt(app.user.uid,10);if(e){var r=parseInt($('a[href="'+config.relative_path+'/unread/new"].navigation-link i').attr("data-content"),10)+1;i("/unread/new",r)}socket.emit("topics.isFollowed",n.topic.tid,function(t,n){if(t){return app.alertError(t.message)}if(n){var a=parseInt($('a[href="'+config.relative_path+'/unread/watched"].navigation-link i').attr("data-content"),10)+1;i("/unread/watched",a)}})}function e(t){$('[data-tid="'+t+'"]').addClass("unread")}$(window).on("action:ajaxify.end",function(n,a){if(a.url){var e=a.url.match(/^topic\/(\d+)/);if(e&&e[1]){delete t[e[1]]}}});socket.on("event:new_post",n)}if(app.user.uid){socket.emit("user.getUnreadCounts",function(n,a){if(n){return app.alert(n.message)}u(a);r(a.unreadChatCount);t.updateNotifCount(a.unreadNotificationCount)})}function u(t){i("/unread",t.unreadTopicCount);i("/unread/new",t.unreadNewTopicCount);i("/unread/watched",t.unreadWatchedTopicCount)}socket.on("event:unread.updateCount",u);socket.on("event:unread.updateChatCount",r);o()});
//# sourceMappingURL=public/src/client/footer.js.map