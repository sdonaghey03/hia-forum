{"version":3,"sources":["public/src/client/groups/list.js"],"names":["define","infinitescroll","Benchpress","Groups","init","loadMoreGroups","$","on","bootbox","prompt","name","length","socket","emit","err","ajaxify","go","utils","slugify","app","alertError","message","params","val","sort","search","direction","loadMore","after","attr","data","done","groups","parse","html","append","nextStart","groupsEl","queryEl","sortEl","query","options","filterHidden","filter","group","empty"],"mappings":"AAAA,aAGAA,OAAO,qBAAsB,uBAAwB,cAAe,SAAUC,EAAgBC,GAC7F,IAAIC,KAEJA,EAAOC,KAAO,WACbH,EAAeG,KAAKD,EAAOE,gBAG3BC,EAAE,6BAA6BC,GAAG,QAAS,WAC1CC,QAAQC,OAAO,kCAAmC,SAAUC,GAC3D,GAAIA,GAAQA,EAAKC,OAAQ,CACxBC,OAAOC,KAAK,iBACXH,KAAMA,GACJ,SAAUI,GACZ,IAAKA,EAAK,CACTC,QAAQC,GAAG,UAAYC,MAAMC,QAAQR,QAC/B,CACNS,IAAIC,WAAWN,EAAIO,iBAMxB,IAAIC,EAASL,MAAMK,SACnBhB,EAAE,gBAAgBiB,IAAID,EAAOE,MAAQ,SAGrClB,EAAE,gBAAgBC,GAAG,QAASJ,EAAOsB,QACrCnB,EAAE,kBAAkBC,GAAG,QAASJ,EAAOsB,QACvCnB,EAAE,gBAAgBC,GAAG,SAAU,WAC9BQ,QAAQC,GAAG,eAAiBV,EAAE,gBAAgBiB,UAIhDpB,EAAOE,eAAiB,SAAUqB,GACjC,GAAIA,EAAY,EAAG,CAClB,OAGDzB,EAAe0B,SAAS,mBACvBH,KAAMlB,EAAE,gBAAgBiB,MACxBK,MAAOtB,EAAE,kCAAkCuB,KAAK,mBAC9C,SAAUC,EAAMC,GAClB,GAAID,GAAQA,EAAKE,OAAOrB,OAAQ,CAC/BT,EAAW+B,MAAM,wBAChBD,OAAQF,EAAKE,QACX,SAAUE,GACZ5B,EAAE,gBAAgB6B,OAAOD,GACzBH,UAEK,CACNA,IAGD,GAAID,GAAQA,EAAKM,UAAW,CAC3B9B,EAAE,kCAAkCuB,KAAK,iBAAkBC,EAAKM,eAKnEjC,EAAOsB,OAAS,WACf,IAAIY,EAAW/B,EAAE,gBACjB,IAAIgC,EAAUhC,EAAE,gBAChB,IAAIiC,EAASjC,EAAE,gBAEfM,OAAOC,KAAK,iBACX2B,MAAOF,EAAQf,MACfkB,SACCjB,KAAMe,EAAOhB,MACbmB,aAAc,OAEb,SAAU5B,EAAKkB,GACjB,GAAIlB,EAAK,CACR,OAAOK,IAAIC,WAAWN,EAAIO,SAE3BW,EAASA,EAAOW,OAAO,SAAUC,GAChC,OAAOA,EAAMlC,OAAS,oBAAsBkC,EAAMlC,OAAS,WAE5DR,EAAW+B,MAAM,wBAChBD,OAAQA,GACN,SAAUE,GACZG,EAASQ,QAAQV,OAAOD,OAG1B,OAAO,OAGR,OAAO/B","file":"public/src/client/groups/list.js","sourcesContent":["'use strict';\n\n\ndefine('forum/groups/list', ['forum/infinitescroll', 'benchpress'], function (infinitescroll, Benchpress) {\n\tvar Groups = {};\n\n\tGroups.init = function () {\n\t\tinfinitescroll.init(Groups.loadMoreGroups);\n\n\t\t// Group creation\n\t\t$('button[data-action=\"new\"]').on('click', function () {\n\t\t\tbootbox.prompt('[[groups:new-group.group_name]]', function (name) {\n\t\t\t\tif (name && name.length) {\n\t\t\t\t\tsocket.emit('groups.create', {\n\t\t\t\t\t\tname: name,\n\t\t\t\t\t}, function (err) {\n\t\t\t\t\t\tif (!err) {\n\t\t\t\t\t\t\tajaxify.go('groups/' + utils.slugify(name));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tapp.alertError(err.message);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\tvar params = utils.params();\n\t\t$('#search-sort').val(params.sort || 'alpha');\n\n\t\t// Group searching\n\t\t$('#search-text').on('keyup', Groups.search);\n\t\t$('#search-button').on('click', Groups.search);\n\t\t$('#search-sort').on('change', function () {\n\t\t\tajaxify.go('groups?sort=' + $('#search-sort').val());\n\t\t});\n\t};\n\n\tGroups.loadMoreGroups = function (direction) {\n\t\tif (direction < 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tinfinitescroll.loadMore('groups.loadMore', {\n\t\t\tsort: $('#search-sort').val(),\n\t\t\tafter: $('[component=\"groups/container\"]').attr('data-nextstart'),\n\t\t}, function (data, done) {\n\t\t\tif (data && data.groups.length) {\n\t\t\t\tBenchpress.parse('partials/groups/list', {\n\t\t\t\t\tgroups: data.groups,\n\t\t\t\t}, function (html) {\n\t\t\t\t\t$('#groups-list').append(html);\n\t\t\t\t\tdone();\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tdone();\n\t\t\t}\n\n\t\t\tif (data && data.nextStart) {\n\t\t\t\t$('[component=\"groups/container\"]').attr('data-nextstart', data.nextStart);\n\t\t\t}\n\t\t});\n\t};\n\n\tGroups.search = function () {\n\t\tvar groupsEl = $('#groups-list');\n\t\tvar queryEl = $('#search-text');\n\t\tvar sortEl = $('#search-sort');\n\n\t\tsocket.emit('groups.search', {\n\t\t\tquery: queryEl.val(),\n\t\t\toptions: {\n\t\t\t\tsort: sortEl.val(),\n\t\t\t\tfilterHidden: true,\n\t\t\t},\n\t\t}, function (err, groups) {\n\t\t\tif (err) {\n\t\t\t\treturn app.alertError(err.message);\n\t\t\t}\n\t\t\tgroups = groups.filter(function (group) {\n\t\t\t\treturn group.name !== 'registered-users' && group.name !== 'guests';\n\t\t\t});\n\t\t\tBenchpress.parse('partials/groups/list', {\n\t\t\t\tgroups: groups,\n\t\t\t}, function (html) {\n\t\t\t\tgroupsEl.empty().append(html);\n\t\t\t});\n\t\t});\n\t\treturn false;\n\t};\n\n\treturn Groups;\n});\n"]}