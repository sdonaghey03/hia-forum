{"version":3,"sources":["public/src/client/topic/events.js"],"names":["define","postTools","threadTools","posts","images","components","translator","Benchpress","Events","events","event:user_status_change","onUserStatusChange","event:voted","updatePostVotesAndUserReputation","event:bookmarked","updateBookmarkCount","event:topic_deleted","setDeleteState","event:topic_restored","event:topic_purged","onTopicPurged","event:topic_locked","setLockedState","event:topic_unlocked","event:topic_pinned","setPinnedState","event:topic_unpinned","event:topic_moved","onTopicMoved","event:post_edited","onPostEdited","event:post_purged","onPostPurged","event:post_deleted","togglePostDeleteState","event:post_restored","posts.bookmark","togglePostBookmark","posts.unbookmark","posts.upvote","togglePostVote","posts.downvote","posts.unvote","event:new_notification","onNewNotification","event:new_post","onNewPost","init","removeListeners","eventName","hasOwnProperty","socket","on","removeListener","data","app","updateUserStatus","$","uid","status","votes","post","pid","filter","index","el","parseInt","closest","attr","reputationElements","html","user","reputation","bookmarks","ajaxify","category","slug","go","editedPostEl","get","editorEl","topicTitle","navbarTitle","find","breadCrumb","length","topic","title","newUrl","window","location","search","history","replaceState","url","protocol","host","config","relative_path","fadeOut","fadeIn","unescape","content","addClass","replaceSelfLinks","wrapImagesInLinks","parent","unloadImages","loadImages","editData","editor","editedISO","utils","toISOString","edited","parse","translate","translated","replaceWith","timeago","trigger","tags","tagsUpdated","first","children","i","value","postData","this","remove","showBottomPostBar","postcount","updatePostCount","require","replies","postEl","toggleClass","isDeleted","hasClass","toggle","privileges","isAdminOrMod","translateHtml","isBookmarked","upvote","downvote","tid","emit"],"mappings":"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","file":"public/src/client/topic/events.js","sourcesContent":["\n'use strict';\n\n\ndefine('forum/topic/events', [\n\t'forum/topic/postTools',\n\t'forum/topic/threadTools',\n\t'forum/topic/posts',\n\t'forum/topic/images',\n\t'components',\n\t'translator',\n\t'benchpress',\n], function (postTools, threadTools, posts, images, components, translator, Benchpress) {\n\tvar Events = {};\n\n\tvar events = {\n\t\t'event:user_status_change': onUserStatusChange,\n\t\t'event:voted': updatePostVotesAndUserReputation,\n\t\t'event:bookmarked': updateBookmarkCount,\n\n\t\t'event:topic_deleted': threadTools.setDeleteState,\n\t\t'event:topic_restored': threadTools.setDeleteState,\n\t\t'event:topic_purged': onTopicPurged,\n\n\t\t'event:topic_locked': threadTools.setLockedState,\n\t\t'event:topic_unlocked': threadTools.setLockedState,\n\n\t\t'event:topic_pinned': threadTools.setPinnedState,\n\t\t'event:topic_unpinned': threadTools.setPinnedState,\n\n\t\t'event:topic_moved': onTopicMoved,\n\n\t\t'event:post_edited': onPostEdited,\n\t\t'event:post_purged': onPostPurged,\n\n\t\t'event:post_deleted': togglePostDeleteState,\n\t\t'event:post_restored': togglePostDeleteState,\n\n\t\t'posts.bookmark': togglePostBookmark,\n\t\t'posts.unbookmark': togglePostBookmark,\n\n\t\t'posts.upvote': togglePostVote,\n\t\t'posts.downvote': togglePostVote,\n\t\t'posts.unvote': togglePostVote,\n\n\t\t'event:new_notification': onNewNotification,\n\t\t'event:new_post': posts.onNewPost,\n\t};\n\n\tEvents.init = function () {\n\t\tEvents.removeListeners();\n\t\tfor (var eventName in events) {\n\t\t\tif (events.hasOwnProperty(eventName)) {\n\t\t\t\tsocket.on(eventName, events[eventName]);\n\t\t\t}\n\t\t}\n\t};\n\n\tEvents.removeListeners = function () {\n\t\tfor (var eventName in events) {\n\t\t\tif (events.hasOwnProperty(eventName)) {\n\t\t\t\tsocket.removeListener(eventName, events[eventName]);\n\t\t\t}\n\t\t}\n\t};\n\n\tfunction onUserStatusChange(data) {\n\t\tapp.updateUserStatus($('[data-uid=\"' + data.uid + '\"] [component=\"user/status\"]'), data.status);\n\t}\n\n\tfunction updatePostVotesAndUserReputation(data) {\n\t\tvar votes = $('[data-pid=\"' + data.post.pid + '\"] [component=\"post/vote-count\"]').filter(function (index, el) {\n\t\t\treturn parseInt($(el).closest('[data-pid]').attr('data-pid'), 10) === parseInt(data.post.pid, 10);\n\t\t});\n\t\tvar reputationElements = $('.reputation[data-uid=\"' + data.post.uid + '\"]');\n\t\tvotes.html(data.post.votes).attr('data-votes', data.post.votes);\n\t\treputationElements.html(data.user.reputation).attr('data-reputation', data.user.reputation);\n\t}\n\n\tfunction updateBookmarkCount(data) {\n\t\t$('[data-pid=\"' + data.post.pid + '\"] .bookmarkCount').filter(function (index, el) {\n\t\t\treturn parseInt($(el).closest('[data-pid]').attr('data-pid'), 10) === parseInt(data.post.pid, 10);\n\t\t}).html(data.post.bookmarks).attr('data-bookmarks', data.post.bookmarks);\n\t}\n\n\tfunction onTopicPurged() {\n\t\tif (ajaxify.data.category && ajaxify.data.category.slug) {\n\t\t\tajaxify.go('category/' + ajaxify.data.category.slug, null, true);\n\t\t}\n\t}\n\n\tfunction onTopicMoved(data) {\n\t\tif (data && data.slug) {\n\t\t\tajaxify.go('topic/' + data.slug, null, true);\n\t\t}\n\t}\n\n\tfunction onPostEdited(data) {\n\t\tif (!data || !data.post) {\n\t\t\treturn;\n\t\t}\n\t\tvar editedPostEl = components.get('post/content', data.post.pid).filter(function (index, el) {\n\t\t\treturn parseInt($(el).closest('[data-pid]').attr('data-pid'), 10) === parseInt(data.post.pid, 10);\n\t\t});\n\n\t\tvar editorEl = $('[data-pid=\"' + data.post.pid + '\"] [component=\"post/editor\"]').filter(function (index, el) {\n\t\t\treturn parseInt($(el).closest('[data-pid]').attr('data-pid'), 10) === parseInt(data.post.pid, 10);\n\t\t});\n\t\tvar topicTitle = components.get('topic/title');\n\t\tvar navbarTitle = components.get('navbar/title').find('span');\n\t\tvar breadCrumb = components.get('breadcrumb/current');\n\n\t\tif (topicTitle.length && data.topic.title && topicTitle.html() !== data.topic.title) {\n\t\t\tajaxify.data.title = data.topic.title;\n\t\t\tvar newUrl = 'topic/' + data.topic.slug + (window.location.search ? window.location.search : '');\n\t\t\thistory.replaceState({ url: newUrl }, null, window.location.protocol + '//' + window.location.host + config.relative_path + '/' + newUrl);\n\n\t\t\ttopicTitle.fadeOut(250, function () {\n\t\t\t\ttopicTitle.html(data.topic.title).fadeIn(250);\n\t\t\t});\n\t\t\tbreadCrumb.fadeOut(250, function () {\n\t\t\t\tbreadCrumb.html(data.topic.title).fadeIn(250);\n\t\t\t});\n\t\t\tnavbarTitle.fadeOut(250, function () {\n\t\t\t\tnavbarTitle.html(data.topic.title).fadeIn(250);\n\t\t\t});\n\t\t}\n\n\t\teditedPostEl.fadeOut(250, function () {\n\t\t\teditedPostEl.html(translator.unescape(data.post.content));\n\t\t\teditedPostEl.find('img:not(.not-responsive)').addClass('img-responsive');\n\t\t\tapp.replaceSelfLinks(editedPostEl.find('a'));\n\t\t\timages.wrapImagesInLinks(editedPostEl.parent());\n\t\t\timages.unloadImages(editedPostEl.parent());\n\t\t\timages.loadImages();\n\t\t\teditedPostEl.fadeIn(250);\n\n\t\t\tvar editData = {\n\t\t\t\teditor: data.editor,\n\t\t\t\teditedISO: utils.toISOString(data.post.edited),\n\t\t\t};\n\n\t\t\tBenchpress.parse('partials/topic/post-editor', editData, function (html) {\n\t\t\t\ttranslator.translate(html, function (translated) {\n\t\t\t\t\thtml = $(translated);\n\t\t\t\t\teditorEl.replaceWith(html);\n\t\t\t\t\t$('[data-pid=\"' + data.post.pid + '\"] [component=\"post/editor\"] .timeago').timeago();\n\t\t\t\t\t$(window).trigger('action:posts.edited', data);\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\n\t\tif (data.topic.tags && tagsUpdated(data.topic.tags)) {\n\t\t\tBenchpress.parse('partials/post_bar', 'tags', { tags: data.topic.tags }, function (html) {\n\t\t\t\tvar tags = $('.tags');\n\n\t\t\t\ttags.fadeOut(250, function () {\n\t\t\t\t\ttags.html(html).fadeIn(250);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\tfunction tagsUpdated(tags) {\n\t\tif (tags.length !== $('.tags').first().children().length) {\n\t\t\treturn true;\n\t\t}\n\n\t\tfor (var i = 0; i < tags.length; i += 1) {\n\t\t\tif (!$('.tags .tag-item[data-tag=\"' + tags[i].value + '\"]').length) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tfunction onPostPurged(postData) {\n\t\tcomponents.get('post', 'pid', postData.pid).fadeOut(500, function () {\n\t\t\t$(this).remove();\n\t\t\tposts.showBottomPostBar();\n\t\t});\n\t\tajaxify.data.postcount -= 1;\n\t\tpostTools.updatePostCount(ajaxify.data.postcount);\n\t\trequire(['forum/topic/replies'], function (replies) {\n\t\t\treplies.onPostPurged(postData);\n\t\t});\n\t}\n\n\tfunction togglePostDeleteState(data) {\n\t\tvar postEl = components.get('post', 'pid', data.pid);\n\n\t\tif (!postEl.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tpostEl.toggleClass('deleted');\n\t\tvar isDeleted = postEl.hasClass('deleted');\n\t\tpostTools.toggle(data.pid, isDeleted);\n\n\t\tif (!ajaxify.data.privileges.isAdminOrMod && parseInt(data.uid, 10) !== parseInt(app.user.uid, 10)) {\n\t\t\tpostEl.find('[component=\"post/tools\"]').toggleClass('hidden', isDeleted);\n\t\t\tif (isDeleted) {\n\t\t\t\tpostEl.find('[component=\"post/content\"]').translateHtml('[[topic:post_is_deleted]]');\n\t\t\t} else {\n\t\t\t\tpostEl.find('[component=\"post/content\"]').html(translator.unescape(data.content));\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction togglePostBookmark(data) {\n\t\tvar el = $('[data-pid=\"' + data.post.pid + '\"] [component=\"post/bookmark\"]').filter(function (index, el) {\n\t\t\treturn parseInt($(el).closest('[data-pid]').attr('data-pid'), 10) === parseInt(data.post.pid, 10);\n\t\t});\n\t\tif (!el.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tel.attr('data-bookmarked', data.isBookmarked);\n\n\t\tel.find('[component=\"post/bookmark/on\"]').toggleClass('hidden', !data.isBookmarked);\n\t\tel.find('[component=\"post/bookmark/off\"]').toggleClass('hidden', data.isBookmarked);\n\t}\n\n\tfunction togglePostVote(data) {\n\t\tvar post = $('[data-pid=\"' + data.post.pid + '\"]');\n\t\tpost.find('[component=\"post/upvote\"]').filter(function (index, el) {\n\t\t\treturn parseInt($(el).closest('[data-pid]').attr('data-pid'), 10) === parseInt(data.post.pid, 10);\n\t\t}).toggleClass('upvoted', data.upvote);\n\t\tpost.find('[component=\"post/downvote\"]').filter(function (index, el) {\n\t\t\treturn parseInt($(el).closest('[data-pid]').attr('data-pid'), 10) === parseInt(data.post.pid, 10);\n\t\t}).toggleClass('downvoted', data.downvote);\n\t}\n\n\tfunction onNewNotification(data) {\n\t\tvar tid = ajaxify.data.tid;\n\t\tif (data && data.tid && parseInt(data.tid, 10) === parseInt(tid, 10)) {\n\t\t\tsocket.emit('topics.markTopicNotificationsRead', [tid]);\n\t\t}\n\t}\n\n\treturn Events;\n});\n"]}