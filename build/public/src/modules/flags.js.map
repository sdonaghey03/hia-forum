{"version":3,"sources":["public/src/modules/flags.js"],"names":["define","Benchpress","Flag","flagModal","flagCommit","showFlagModal","data","parseModal","html","$","on","remove","find","createFlag","type","id","this","text","val","modal","checkFlagButtonEnable","tplData","callback","parse","require","translator","translate","reason","socket","emit","err","app","alertError","message","alertSuccess","removeAttr","attr"],"mappings":"AAAA,aAGAA,OAAO,SAAU,cAAe,SAAUC,GACzC,IAAIC,KACJ,IAAIC,EACJ,IAAIC,EAEJF,EAAKG,cAAgB,SAAUC,GAC9BC,EAAWD,EAAM,SAAUE,GAC1BL,EAAYM,EAAED,GAEdL,EAAUO,GAAG,kBAAmB,WAC/BP,EAAUQ,WAGXP,EAAaD,EAAUS,KAAK,qBAE5BT,EAAUO,GAAG,QAAS,eAAgB,WACrCG,EAAWP,EAAKQ,KAAMR,EAAKS,GAAIN,EAAEO,MAAMC,UAGxCb,EAAWM,GAAG,QAAS,WACtBG,EAAWP,EAAKQ,KAAMR,EAAKS,GAAIZ,EAAUS,KAAK,uBAAuBM,SAGtEf,EAAUgB,MAAM,QAEhBhB,EAAUS,KAAK,uBAAuBF,GAAG,oBAAqBU,MAIhE,SAASb,EAAWc,EAASC,GAC5BrB,EAAWsB,MAAM,6BAA8BF,EAAS,SAAUb,GACjEgB,SAAS,cAAe,SAAUC,GACjCA,EAAWC,UAAUlB,EAAMc,OAK9B,SAAST,EAAWC,EAAMC,EAAIY,GAC7B,IAAKb,IAASC,IAAOY,EAAQ,CAC5B,OAEDC,OAAOC,KAAK,gBAAkBf,KAAMA,EAAMC,GAAIA,EAAIY,OAAQA,GAAU,SAAUG,GAC7E,GAAIA,EAAK,CACR,OAAOC,IAAIC,WAAWF,EAAIG,SAG3B9B,EAAUgB,MAAM,QAChBY,IAAIG,aAAa,oCAInB,SAASd,IACR,GAAIjB,EAAUS,KAAK,uBAAuBM,MAAO,CAChDd,EAAW+B,WAAW,gBAChB,CACN/B,EAAWgC,KAAK,WAAY,OAI9B,OAAOlC","file":"public/src/modules/flags.js","sourcesContent":["'use strict';\n\n\ndefine('flags', ['benchpress'], function (Benchpress) {\n\tvar Flag = {};\n\tvar flagModal;\n\tvar flagCommit;\n\n\tFlag.showFlagModal = function (data) {\n\t\tparseModal(data, function (html) {\n\t\t\tflagModal = $(html);\n\n\t\t\tflagModal.on('hidden.bs.modal', function () {\n\t\t\t\tflagModal.remove();\n\t\t\t});\n\n\t\t\tflagCommit = flagModal.find('#flag-post-commit');\n\n\t\t\tflagModal.on('click', '.flag-reason', function () {\n\t\t\t\tcreateFlag(data.type, data.id, $(this).text());\n\t\t\t});\n\n\t\t\tflagCommit.on('click', function () {\n\t\t\t\tcreateFlag(data.type, data.id, flagModal.find('#flag-reason-custom').val());\n\t\t\t});\n\n\t\t\tflagModal.modal('show');\n\n\t\t\tflagModal.find('#flag-reason-custom').on('keyup blur change', checkFlagButtonEnable);\n\t\t});\n\t};\n\n\tfunction parseModal(tplData, callback) {\n\t\tBenchpress.parse('partials/modals/flag_modal', tplData, function (html) {\n\t\t\trequire(['translator'], function (translator) {\n\t\t\t\ttranslator.translate(html, callback);\n\t\t\t});\n\t\t});\n\t}\n\n\tfunction createFlag(type, id, reason) {\n\t\tif (!type || !id || !reason) {\n\t\t\treturn;\n\t\t}\n\t\tsocket.emit('flags.create', { type: type, id: id, reason: reason }, function (err) {\n\t\t\tif (err) {\n\t\t\t\treturn app.alertError(err.message);\n\t\t\t}\n\n\t\t\tflagModal.modal('hide');\n\t\t\tapp.alertSuccess('[[flags:modal-submit-success]]');\n\t\t});\n\t}\n\n\tfunction checkFlagButtonEnable() {\n\t\tif (flagModal.find('#flag-reason-custom').val()) {\n\t\t\tflagCommit.removeAttr('disabled');\n\t\t} else {\n\t\t\tflagCommit.attr('disabled', true);\n\t\t}\n\t}\n\n\treturn Flag;\n});\n"]}